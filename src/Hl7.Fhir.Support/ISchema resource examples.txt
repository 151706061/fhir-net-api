{   
    (*
        "$id": "http://hl7.org/fhir/StructureDefinition/Element",
        "title": "Base for all elements",
        "description": "Base definition for all elements in a resource.",

        "fhir:name": "Element",
        "fhir:kind": "datatype",
    *)

    invariant: "children().exists()"  (* fhir-key: "ele-1" *)  
    [ // fail block
        "fail": "[{fhir-key}]: All FHIR elements must have a @value or children"
        // "warn": "something else"
    ]

    "children":
    [
        "id":
        [
            "fhir:representation": "xmlAttr",
            maxItems: 1,
            type: "id",            
        ],
        "extension":
        [          
            ref: "Extension"  (* "fhir:profileref": "http://hl7.org/fhir/StructureDefinition/Extension" *)
        ]

        additionalProperties: "true"
    ]


}


{
    "$id": "http://hl7.org/fhir/StructureDefinition/Observation",

    "fhir:name": "Observation",
    "fhir:kind": "resource",

    ref: "DomainResource"  (* "fhir:base": "http://hl7.org/fhir/StructureDefinition/DomainResource" *)

    "properties":
    [
        "code":
        {
            minItems: 1, maxItems: 1,
            invariant( "$this in 'http://hl7.org/fhir/ValueSet/observation-codes'") (* "fhir-binding-strength": "example" *),
            //or "enum": "'http://hl7.org/fhir/ValueSet/observation-codes'"
        },

        "encounter":
        [
            maxItems: 1,
            ref: "Reference"  (*   *)
            
            // Bit verbose, this
            "properties":
            [
                "reference":
                {
                    "ref": Reference,   // profile
                    reference { ref: "Encounter" (* "fhir:profile-ref" *) }    // target-profile
                }
            ]            
        ],

        "effective":
        [
            maxItems: 1,
            anyOf: [{ ref: "dateTime" }, { ref: "Period" }]
        ]

        allowUnhandledProperties: "false"      // like allowProperties - but this tracks which properties have not been hit by a rule in any schema or subschema
    ]
}