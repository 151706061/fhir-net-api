# Repo: FirelyTeam/firely-net-sdk
# File: build/templates/apply-versioning-steps-template.yml

steps:
- task: PowerShell@2
  displayName: Retrieve current version
  inputs:
    targetType: filePath
    filePath: $(Build.SourcesDirectory)/build/RetrieveVersion.ps1
- powershell: |
     if ($(isTagBranch) -eq $false)
     {  
        # append a build number when we are not releasing
        $(CurrentSuffix) = $(CurrentSuffix)-$(Build.BuildNumber)
     }
  displayName: 'Setting suffix'
- task: PowerShell@2
  displayName: Setting version
  inputs:
    targetType: filePath
    filePath: $(Build.SourcesDirectory)/build/UpdateVersion.ps1
    arguments: -propFile $(Build.SourcesDirectory)/src/firely-net-sdk.props -newVersion $(CurrentVersion) -suffix $(CurrentSuffix)
- task: PowerShell@2
  displayName: Setting version for common projects
  inputs:
    targetType: filePath
    filePath: $(Build.SourcesDirectory)/build/UpdateVersion.ps1
    arguments: -propFile $(Build.SourcesDirectory)/common/src/firely-net-common.props -newVersion $(CurrentVersion) -suffix $(CurrentSuffix)
